!function(e){"use strict";e.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[2,2],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:40,defaultSizeY:40,minSizeX:2,maxSizeX:null,minSizeY:2,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","se","e","n","w","ne","sw","nw"],start:function(){window.dispatchEvent(new Event("resize"))},resize:function(){window.dispatchEvent(new Event("resize"))},stop:function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},300)}},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(t,i){var n=this;e.extend(this,t),this.resizable=e.extend({},t.resizable||{}),this.draggable=e.extend({},t.draggable||{});var r=!1;this.layoutChanged=function(){r||(r=!0,i(function(){r=!1,n.loaded&&n.floatItemsUp(),n.updateHeight(n.movingItem?n.movingItem.sizeY:0)}))},this.grid=[],this.destroy=function(){this.grid&&(this.grid.length=0,this.grid=null),this.$element=null},this.setOptions=function(t){if(t)if(t=e.extend({},t),t.draggable&&(e.extend(this.draggable,t.draggable),delete t.draggable),t.resizable&&(e.extend(this.resizable,t.resizable),delete t.resizable),e.extend(this,t),this.margins&&2===this.margins.length)for(var i=0,n=this.margins.length;n>i;++i)this.margins[i]=parseInt(this.margins[i],10),isNaN(this.margins[i])&&(this.margins[i]=0);else this.margins=[0,0]},this.canItemOccupy=function(e,t,i){return t>-1&&i>-1&&e.sizeX+i<=this.columns&&e.sizeY+t<=this.maxRows},this.autoSetItemPosition=function(e){for(var t=0;t<this.maxRows;++t)for(var i=0;i<this.columns;++i){var n=this.getItems(t,i,e.sizeX,e.sizeY,e);if(0===n.length&&this.canItemOccupy(e,t,i))return void this.putItem(e,t,i)}throw new Error("Unable to place item!")},this.getItems=function(e,t,i,n,r){var s=[];i&&n||(i=n=1),!r||r instanceof Array||(r=[r]);for(var o=0;n>o;++o)for(var a=0;i>a;++a){var l=this.getItem(e+o,t+a,r);!l||r&&-1!==r.indexOf(l)||-1!==s.indexOf(l)||s.push(l)}return s},this.getBoundingBox=function(e){if(0===e.length)return null;if(1===e.length)return{row:e[0].row,col:e[0].col,sizeY:e[0].sizeY,sizeX:e[0].sizeX};for(var t=0,i=0,n=9999,r=9999,s=0,o=e.length;o>s;++s){var a=e[s];n=Math.min(a.row,n),r=Math.min(a.col,r),t=Math.max(a.row+a.sizeY,t),i=Math.max(a.col+a.sizeX,i)}return{row:n,col:r,sizeY:t-n,sizeX:i-r}},this.removeItem=function(e){for(var t=0,i=this.grid.length;i>t;++t){var n=this.grid[t];if(n){var r=n.indexOf(e);if(-1!==r){n[r]=null;break}}}this.layoutChanged()},this.getItem=function(e,t,i){!i||i instanceof Array||(i=[i]);for(var n=1;e>-1;){for(var r=1,s=t;s>-1;){var o=this.grid[e];if(o){var a=o[s];if(a&&(!i||-1===i.indexOf(a))&&a.sizeX>=r&&a.sizeY>=n)return a}++r,--s}--e,++n}return null},this.putItems=function(e){for(var t=0,i=e.length;i>t;++t)this.putItem(e[t])},this.putItem=function(e,t,i,n){if(("undefined"==typeof t||null===t)&&(t=e.row,i=e.col,"undefined"==typeof t||null===t))return void this.autoSetItemPosition(e);if(this.canItemOccupy(e,t,i)||(i=Math.min(this.columns-e.sizeX,Math.max(0,i)),t=Math.min(this.maxRows-e.sizeY,Math.max(0,t))),null!==e.oldRow&&"undefined"!=typeof e.oldRow){var r=e.oldRow===t&&e.oldColumn===i,s=this.grid[t]&&this.grid[t][i]===e;if(r&&s)return e.row=t,void(e.col=i);var o=this.grid[e.oldRow];o&&o[e.oldColumn]===e&&delete o[e.oldColumn]}e.oldRow=e.row=t,e.oldColumn=e.col=i,this.moveOverlappingItems(e,n),this.grid[t]||(this.grid[t]=[]),this.grid[t][i]=e,this.movingItem===e&&this.floatItemUp(e),this.layoutChanged()},this.swapItems=function(e,t){this.grid[e.row][e.col]=t,this.grid[t.row][t.col]=e;var i=e.row,n=e.col;e.row=t.row,e.col=t.col,t.row=i,t.col=n},this.moveOverlappingItems=function(e,t){t?-1===t.indexOf(e)&&(t=t.slice(0),t.push(e)):t=[e];var i=this.getItems(e.row,e.col,e.sizeX,e.sizeY,t);this.moveItemsDown(i,e.row+e.sizeY,t)},this.moveItemsDown=function(e,t,i){if(e&&0!==e.length){e.sort(function(e,t){return e.row-t.row}),i=i?i.slice(0):[];var n,r,s,o={};for(r=0,s=e.length;s>r;++r){n=e[r];var a=o[n.col];("undefined"==typeof a||n.row<a)&&(o[n.col]=n.row)}for(r=0,s=e.length;s>r;++r){n=e[r];var l=t-o[n.col];this.moveItemDown(n,n.row+l,i),i.push(n)}}},this.moveItemDown=function(e,t,i){if(!(e.row>=t)){for(;e.row<t;)++e.row,this.moveOverlappingItems(e,i);this.putItem(e,e.row,e.col,i)}},this.floatItemsUp=function(){if(this.floating!==!1)for(var e=0,t=this.grid.length;t>e;++e){var i=this.grid[e];if(i)for(var n=0,r=i.length;r>n;++n){var s=i[n];s&&this.floatItemUp(s)}}},this.floatItemUp=function(e){if(this.floating!==!1){for(var t=e.col,i=e.sizeY,n=e.sizeX,r=null,s=null,o=e.row-1;o>-1;){var a=this.getItems(o,t,n,i,e);if(0!==a.length)break;r=o,s=t,--o}null!==r&&this.putItem(e,r,s)}},this.updateHeight=function(e){var t=this.minRows;e=e||0;for(var i=this.grid.length;i>=0;--i){var n=this.grid[i];if(n)for(var r=0,s=n.length;s>r;++r)n[r]&&(t=Math.max(t,i+e+n[r].sizeY))}this.gridHeight=this.maxRows-t>0?Math.min(this.maxRows,t):Math.max(this.maxRows,t)},this.pixelsToRows=function(e,t){return t===!0?Math.ceil(e/this.curRowHeight):t===!1?Math.floor(e/this.curRowHeight):Math.round(e/this.curRowHeight)},this.pixelsToColumns=function(e,t){return t===!0?Math.ceil(e/this.curColWidth):t===!1?Math.floor(e/this.curColWidth):Math.round(e/this.curColWidth)}}]).directive("gridster",["$timeout","$rootScope","$window",function(t,i,n){return{restrict:"EAC",transclude:!0,replace:!0,template:'<div ng-class="gridsterClass()"><div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div><div class="gridster-content" ng-transclude></div></div>',controller:"GridsterCtrl",controllerAs:"gridster",scope:{config:"=?gridster"},compile:function(){return function(r,s,o,a){function l(){var e=s[0].offsetWidth||parseInt(s.css("width"),10);e&&e!==c&&!a.movingItem&&(c=e,a.loaded&&s.removeClass("gridster-loaded"),g(),a.loaded&&s.addClass("gridster-loaded"),i.$broadcast("gridster-resized",[e,s[0].offsetHeight],a))}function d(){l(),t(function(){r.$apply()})}a.loaded=!1,a.$element=s,r.gridsterClass=function(){return{gridster:!0,"gridster-desktop":!a.isMobile,"gridster-mobile":a.isMobile,"gridster-loaded":a.loaded}},r.previewStyle=function(){return a.movingItem?{display:"block",height:a.movingItem.sizeY*a.curRowHeight-a.margins[0]+"px",width:a.movingItem.sizeX*a.curColWidth-a.margins[1]+"px",top:a.movingItem.row*a.curRowHeight+(a.outerMargin?a.margins[0]:0)+"px",left:a.movingItem.col*a.curColWidth+(a.outerMargin?a.margins[1]:0)+"px"}:{display:"none"}};var g=function(){a.setOptions(r.config),a.curWidth="auto"===a.width?s[0].offsetWidth||parseInt(s.css("width"),10):a.width,a.curColWidth="auto"===a.colWidth?(a.curWidth+(a.outerMargin?-a.margins[1]:a.margins[1]))/a.columns:a.colWidth,a.curRowHeight=a.rowHeight,"string"==typeof a.rowHeight&&("match"===a.rowHeight?a.curRowHeight=Math.round(a.curColWidth):-1!==a.rowHeight.indexOf("*")?a.curRowHeight=Math.round(a.curColWidth*a.rowHeight.replace("*","").replace(" ","")):-1!==a.rowHeight.indexOf("/")&&(a.curRowHeight=Math.round(a.curColWidth/a.rowHeight.replace("/","").replace(" ","")))),a.isMobile=a.mobileModeEnabled&&a.curWidth<=a.mobileBreakPoint;for(var e=0,t=a.grid.length;t>e;++e){var i=a.grid[e];if(i)for(var n=0,o=i.length;o>n;++n)if(i[n]){var l=i[n];l.setElementPosition(),l.setElementSizeY(),l.setElementSizeX()}}h()};r.$watch("config",g,!0),r.$watch(function(){return a.isMobile},function(){i.$broadcast("gridster-mobile-changed",a)}),r.$watch(function(){return a.draggable},function(){i.$broadcast("gridster-draggable-changed",a)},!0),r.$watch(function(){return a.resizable},function(){i.$broadcast("gridster-resizable-changed",a)},!0);var h=function(){s.css("height",a.gridHeight*a.curRowHeight+(a.outerMargin?a.margins[0]:-a.margins[0])+"px")};r.$watch(function(){return a.gridHeight},h),r.$watch(function(){return a.movingItem},function(){a.updateHeight(a.movingItem?a.movingItem.sizeY:0)});var c=s[0].offsetWidth||parseInt(s.css("width"),10);"function"==typeof s.resize?s.resize(d):r.$watch(function(){return s[0].offsetWidth||parseInt(s.css("width"),10)},l);var u=e.element(n);u.on("resize",d),r.$on("$destroy",function(){a.destroy(),u.off("resize",d)}),t(function(){r.$watch("gridster.floating",function(){a.floatItemsUp()}),a.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(e,t){this.$element=e,this.gridster=t,this.sizeX=t.defaultSizeX,this.sizeY=t.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(e,t){this.gridster.putItem(this,e,t),this.isMoving()||this.setElementPosition()},this.setSize=function(e,t,i){e=e.toUpperCase();var n="size"+e,r="Size"+e;if(""!==t){t=parseInt(t,10),(isNaN(t)||0===t)&&(t=this.gridster["default"+r]);var s="X"===e?this.gridster.columns:this.gridster.maxRows;this["max"+r]&&(s=Math.min(this["max"+r],s)),this.gridster["max"+r]&&(s=Math.min(this.gridster["max"+r],s)),"X"===e&&this.cols?s-=this.cols:"Y"===e&&this.rows&&(s-=this.rows);var o=0;this["min"+r]&&(o=Math.max(this["min"+r],o)),this.gridster["min"+r]&&(o=Math.max(this.gridster["min"+r],o)),t=Math.max(Math.min(t,s),o);var a=this[n]!==t||this["old"+r]&&this["old"+r]!==t;return this["old"+r]=this[n]=t,this.isMoving()||this["setElement"+r](),!i&&a&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),a}},this.setSizeY=function(e,t){return this.setSize("Y",e,t)},this.setSizeX=function(e,t){return this.setSize("X",e,t)},this.setElementPosition=function(){this.$element.css(this.gridster.isMobile?{marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}:{margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterTouch",[function(){return function(e,t,i,n){var r,s,o={},a=function(e){if(Object.keys)return Object.keys(e).length;var t,i=0;for(t in e)++i;return i},l=function(e){for(var t=0,i=0,n=navigator.userAgent.match(/\bMSIE\b/),r=e;null!=r;r=r.offsetParent)n&&(!document.documentMode||document.documentMode<8)&&"relative"===r.currentStyle.position&&r.offsetParent&&"relative"===r.offsetParent.currentStyle.position&&r.offsetLeft===r.offsetParent.offsetLeft?i+=r.offsetTop:(t+=r.offsetLeft,i+=r.offsetTop);return{x:t,y:i}},d=l(e),g=function(r){if("mousemove"!==r.type||0!==a(o)){for(var s=!0,c=r.changedTouches?r.changedTouches:[r],u=0;u<c.length;++u){var m=c[u],f="undefined"!=typeof m.identifier?m.identifier:"undefined"!=typeof m.pointerId?m.pointerId:1;if("undefined"==typeof m.pageX)if(m.pageX=m.offsetX+d.x,m.pageY=m.offsetY+d.y,m.srcElement.offsetParent===e&&document.documentMode&&8===document.documentMode&&"mousedown"===m.type)m.pageX+=m.srcElement.offsetLeft,m.pageY+=m.srcElement.offsetTop;else if(m.srcElement!==e&&!document.documentMode||document.documentMode<8){for(var v=-2,p=-2,w=m.srcElement;null!==w;w=w.parentNode)v+=w.scrollLeft?w.scrollLeft:0,p+=w.scrollTop?w.scrollTop:0;m.pageX=m.clientX+v,m.pageY=m.clientY+p}var z=m.pageX,b=m.pageY;r.type.match(/(start|down)$/i)?(d=l(e),o[f]&&(n&&n({target:r.target,which:r.which,pointerId:f,pageX:z,pageY:b}),delete o[f]),t&&s&&(s=t({target:r.target,which:r.which,pointerId:f,pageX:z,pageY:b})),o[f]={x:z,y:b},e.msSetPointerCapture?e.msSetPointerCapture(f):"mousedown"===r.type&&1===a(o)&&(h?e.setCapture(!0):(document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",g,!1)))):r.type.match(/move$/i)?!o[f]||o[f].x===z&&o[f].y===b||(i&&s&&(s=i({target:r.target,which:r.which,pointerId:f,pageX:z,pageY:b})),o[f].x=z,o[f].y=b):o[f]&&r.type.match(/(up|end|cancel)$/i)&&(n&&s&&(s=n({target:r.target,which:r.which,pointerId:f,pageX:z,pageY:b})),delete o[f],e.msReleasePointerCapture?e.msReleasePointerCapture(f):"mouseup"===r.type&&0===a(o)&&(h?e.releaseCapture():(document.removeEventListener("mousemove",g,!1),document.removeEventListener("mouseup",g,!1))))}s&&(r.preventDefault&&r.preventDefault(),r.preventManipulation&&r.preventManipulation(),r.preventMouseEvent&&r.preventMouseEvent())}},h=!1;return this.enable=function(){window.navigator.msPointerEnabled?(e.addEventListener("MSPointerDown",g,!1),e.addEventListener("MSPointerMove",g,!1),e.addEventListener("MSPointerUp",g,!1),e.addEventListener("MSPointerCancel",g,!1),"undefined"!=typeof e.style.msContentZooming&&(r=e.style.msContentZooming,e.style.msContentZooming="none"),"undefined"!=typeof e.style.msTouchAction&&(s=e.style.msTouchAction,e.style.msTouchAction="none")):e.addEventListener?(e.addEventListener("touchstart",g,!1),e.addEventListener("touchmove",g,!1),e.addEventListener("touchend",g,!1),e.addEventListener("touchcancel",g,!1),e.addEventListener("mousedown",g,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(h=!0,e.addEventListener("mousemove",g,!1),e.addEventListener("mouseup",g,!1))):e.attachEvent&&e.setCapture&&(h=!0,e.attachEvent("onmousedown",function(){return g(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmousemove",function(){return g(window.event),window.event.returnValue=!1,!1}),e.attachEvent("onmouseup",function(){return g(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(e.removeEventListener("MSPointerDown",g,!1),e.removeEventListener("MSPointerMove",g,!1),e.removeEventListener("MSPointerUp",g,!1),e.removeEventListener("MSPointerCancel",g,!1),r&&(e.style.msContentZooming=r),s&&(e.style.msTouchAction=s)):e.removeEventListener?(e.removeEventListener("touchstart",g,!1),e.removeEventListener("touchmove",g,!1),e.removeEventListener("touchend",g,!1),e.removeEventListener("touchcancel",g,!1),e.removeEventListener("mousedown",g,!1),e.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(h=!0,e.removeEventListener("mousemove",g,!1),e.removeEventListener("mouseup",g,!1))):e.detachEvent&&e.setCapture&&(h=!0,e.detachEvent("onmousedown"),e.detachEvent("onmousemove"),e.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$timeout","$window","GridsterTouch",function(t,i,n,r){function s(s,o,a,l,d){function g(t){if(-1!==T.indexOf(t.target.nodeName.toLowerCase()))return!1;if(e.element(t.target).hasClass("gridster-item-resizable-handler"))return!1;if(e.element(t.target).attr("onclick")||e.element(t.target).attr("ng-click"))return!1;switch(t.which){case 1:break;case 2:case 3:return}return X=t.pageX,M=t.pageY,v=parseInt(s.css("left"),10),p=parseInt(s.css("top"),10),w=s[0].offsetWidth,z=s[0].offsetHeight,b=l.col,y=l.row,u(t),!0}function h(e){if(!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing"))return!1;var t=a.curWidth-1;I=e.pageX,Y=e.pageY;var i=I-X+C,n=Y-M+E;C=E=0,X=I,M=Y;var r=i,o=n;return L>v+r?(i=L-v,C=r-i):v+w+r>t&&(i=t-v-w,C=r-i),S>p+o?(n=S-p,E=o-n):p+z+o>$&&(n=$-p-z,E=o-n),v+=i,p+=n,s.css({top:p+"px",left:v+"px"}),m(e),!0}function c(e){return!s.hasClass("gridster-item-moving")||s.hasClass("gridster-item-resizing")?!1:(C=E=0,f(e),!0)}function u(e){s.addClass("gridster-item-moving"),a.movingItem=l,a.updateHeight(l.sizeY),o.$apply(function(){a.draggable&&a.draggable.start&&a.draggable.start(e,s,d)})}function m(e){var t=l.row,i=l.col,r=a.draggable&&a.draggable.drag,g=a.draggable.scrollSensitivity,h=a.draggable.scrollSpeed,c=a.pixelsToRows(p),u=a.pixelsToColumns(v),m=a.getItems(c,u,l.sizeX,l.sizeY,l),f=0!==m.length;if(a.swapping===!0&&f){var w=a.getBoundingBox(m),z=w.sizeX===l.sizeX&&w.sizeY===l.sizeY,b=w.row===c,y=w.col===u,x=b&&y,I=b||y;if(z&&1===m.length){if(x)a.swapItems(l,m[0]);else if(I)return}else if(w.sizeX<=l.sizeX&&w.sizeY<=l.sizeY&&I)for(var Y=l.row<=c?l.row:c+l.sizeY,X=l.col<=u?l.col:u+l.sizeX,M=Y-w.row,C=X-w.col,E=0,S=m.length;S>E;++E){var $=m[E],L=a.getItems($.row+M,$.col+C,$.sizeX,$.sizeY,l);0===L.length&&a.putItem($,$.row+M,$.col+C)}}a.pushing===!1&&f||(l.row=c,l.col=u),e.pageY-R.body.scrollTop<g?R.body.scrollTop=R.body.scrollTop-h:n.innerHeight-(e.pageY-R.body.scrollTop)<g&&(R.body.scrollTop=R.body.scrollTop+h),e.pageX-R.body.scrollLeft<g?R.body.scrollLeft=R.body.scrollLeft-h:n.innerWidth-(e.pageX-R.body.scrollLeft)<g&&(R.body.scrollLeft=R.body.scrollLeft+h),(r||t!==l.row||i!==l.col)&&o.$apply(function(){r&&a.draggable.drag(e,s,d)})}function f(e){s.removeClass("gridster-item-moving");var t=a.pixelsToRows(p),i=a.pixelsToColumns(v);(a.pushing!==!1||0===a.getItems(t,i,l.sizeX,l.sizeY,l).length)&&(l.row=t,l.col=i),a.movingItem=null,l.setPosition(l.row,l.col),o.$apply(function(){a.draggable&&a.draggable.stop&&a.draggable.stop(e,s,d)})}var v,p,w,z,b,y,x,I=0,Y=0,X=0,M=0,C=0,E=0,S=0,$=9999,L=0,R=t[0],T=["select","input","textarea","button"],H=!1,P=null;this.enable=function(){var t=this;i(function(){t.disable(),a.draggable&&a.draggable.handle?(P=e.element(s[0].querySelector(a.draggable.handle)),0===P.length&&(P=s)):P=s,x=new r(P[0],g,h,c),x.enable(),H=!0})},this.disable=function(){H&&(x.disable(),x=void 0,H=!1)},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){this.disable()}}return s}]).factory("GridsterResizable",["GridsterTouch",function(t){function i(i,n,r,s,o){function a(a){function l(e){switch(e.which){case 1:break;case 2:case 3:return}return b=r.draggable.enabled,b&&(r.draggable.enabled=!1,n.$broadcast("gridster-draggable-changed",r)),X=e.pageX,M=e.pageY,m=parseInt(i.css("left"),10),f=parseInt(i.css("top"),10),v=i[0].offsetWidth,p=i[0].offsetHeight,w=s.sizeX,z=s.sizeY,d(e),!0}function d(e){i.addClass("gridster-item-moving"),i.addClass("gridster-item-resizing"),r.movingItem=s,s.setElementSizeX(),s.setElementSizeY(),s.setElementPosition(),r.updateHeight(1),n.$apply(function(){r.resizable&&r.resizable.start&&r.resizable.start(e,i,o)})}function g(e){var t=r.curWidth-1;I=e.pageX,Y=e.pageY;var n=I-X+C,s=Y-M+E;C=E=0,X=I,M=Y;var o=s,a=n;return x.indexOf("n")>=0&&(p-o<R()?(s=p-R(),E=o-s):S>f+o&&(s=S-f,E=o-s),f+=s,p-=s),x.indexOf("s")>=0&&(p+o<R()?(s=R()-p,E=o-s):f+p+o>$&&(s=$-f-p,E=o-s),p+=s),x.indexOf("w")>=0&&(v-a<T()?(n=v-T(),C=a-n):L>m+a&&(n=L-m,C=a-n),m+=n,v-=n),x.indexOf("e")>=0&&(v+a<T()?(n=T()-v,C=a-n):m+v+a>t&&(n=t-m-v,C=a-n),v+=n),i.css({top:f+"px",left:m+"px",width:v+"px",height:p+"px"}),c(e),!0}function h(e){return r.draggable.enabled!==b&&(r.draggable.enabled=b,n.$broadcast("gridster-draggable-changed",r)),C=E=0,u(e),!0}function c(e){var t=s.row,l=s.col,d=s.sizeX,g=s.sizeY,h=r.resizable&&r.resizable.resize,c=s.col;-1!==["w","nw","sw"].indexOf(a)&&(c=r.pixelsToColumns(m,!1));var u=s.row;-1!==["n","ne","nw"].indexOf(a)&&(u=r.pixelsToRows(f,!1));var w=s.sizeX;-1===["n","s"].indexOf(a)&&(w=r.pixelsToColumns(v,!0));var z=s.sizeY;-1===["e","w"].indexOf(a)&&(z=r.pixelsToRows(p,!0)),(r.pushing!==!1||0===r.getItems(u,c,w,z,s).length)&&(s.row=u,s.col=c,s.sizeX=w,s.sizeY=z);var b=s.row!==t||s.col!==l||s.sizeX!==d||s.sizeY!==g;(h||b)&&n.$apply(function(){h&&r.resizable.resize(e,i,o)})}function u(e){i.removeClass("gridster-item-moving"),i.removeClass("gridster-item-resizing"),r.movingItem=null,s.setPosition(s.row,s.col),s.setSizeY(s.sizeY),s.setSizeX(s.sizeX),n.$apply(function(){r.resizable&&r.resizable.stop&&r.resizable.stop(e,i,o)})}var m,f,v,p,w,z,b,y,x=a,I=0,Y=0,X=0,M=0,C=0,E=0,S=0,$=9999,L=0,R=function(){return r.curRowHeight-r.margins[0]},T=function(){return r.curColWidth-r.margins[1]},H=null;this.enable=function(){H||(H=e.element('<div class="gridster-item-resizable-handler handle-'+x+'"></div>'),i.append(H)),y=new t(H[0],l,g,h),y.enable()},this.disable=function(){H&&(H.remove(),H=null),y.disable(),y=void 0},this.destroy=function(){this.disable()}}var l=[],d=r.resizable.handles;"string"==typeof d&&(d=r.resizable.handles.split(","));for(var g=!1,h=0,c=d.length;c>h;h++)l.push(new a(d[h]));this.enable=function(){if(!g){for(var e=0,t=l.length;t>e;e++)l[e].enable();g=!0}},this.disable=function(){if(g){for(var e=0,t=l.length;t>e;e++)l[e].disable();g=!1}},this.toggle=function(e){e?this.enable():this.disable()},this.destroy=function(){for(var e=0,t=l.length;t>e;e++)l[e].destroy()}}return i}]).factory("gridsterDebounce",function(){return function(e,t,i){var n;return function(){var r=this,s=arguments,o=function(){n=null,i||e.apply(r,s)},a=i&&!n;clearTimeout(n),n=setTimeout(o,t),a&&e.apply(r,s)}}}).directive("gridsterItem",["$parse","$rootScope","GridsterDraggable","GridsterResizable","gridsterDebounce",function(e,t,i,n,r){return{restrict:"EA",controller:"GridsterItemCtrl",require:["^gridster","gridsterItem"],link:function(s,o,a,l){function d(){f.setPosition(f.row,f.col),w.row&&w.row.assign&&w.row.assign(s,f.row),w.col&&w.col.assign&&w.col.assign(s,f.col)}function g(){var e=f.setSizeX(f.sizeX,!0);e&&w.sizeX&&w.sizeX.assign&&w.sizeX.assign(s,f.sizeX);var i=f.setSizeY(f.sizeY,!0);i&&w.sizeY&&w.sizeY.assign&&w.sizeY.assign(s,f.sizeY),(e||i)&&(f.gridster.moveOverlappingItems(f),m.layoutChanged(),t.$broadcast("gridster-item-resized",f))}function h(){var e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}var c,u=a.gridsterItem,m=l[0],f=l[1];if(u){var v=e(u);c=v(s)||{},!c&&v.assign&&(c={row:f.row,col:f.col,sizeX:f.sizeX,sizeY:f.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},v.assign(s,c))}else c=a;f.init(o,m),o.addClass("gridster-item");for(var p=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],w={},z=[],b=function(t){var i;if("string"==typeof c[t])i=c[t];else if("string"==typeof c[t.toLowerCase()])i=c[t.toLowerCase()];else{if(!u)return;i=u+"."+t}z.push('"'+t+'":'+i),w[t]=e(i);var n=w[t](s);"number"==typeof n&&(f[t]=n)},y=0,x=p.length;x>y;++y)b(p[y]);var I="{"+z.join(",")+"}";s.$watchCollection(I,function(e,t){for(var i in e){var n=e[i],r=t[i];r!==n&&(n=parseInt(n,10),isNaN(n)||(f[i]=n))}}),s.$watch(function(){return f.row+","+f.col},d),s.$watch(function(){return f.sizeY+","+f.sizeX+","+f.minSizeX+","+f.maxSizeX+","+f.minSizeY+","+f.maxSizeY},g);var Y=new i(o,s,m,f,c),X=new n(o,s,m,f,c);X.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled),Y.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled),s.$on("gridster-draggable-changed",function(){Y.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled)}),s.$on("gridster-resizable-changed",function(){X.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled)}),s.$on("gridster-resized",function(){X.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled)}),s.$on("gridster-mobile-changed",function(){X.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled),Y.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled)});var M=r(function(){s.$apply(function(){s.$broadcast("gridster-item-transition-end",f)})},10);return o.on(h(),M),s.$broadcast("gridster-item-initialized",f),s.$on("$destroy",function(){try{X.destroy(),Y.destroy()}catch(e){}try{m.removeItem(f)}catch(e){}try{f.destroy()}catch(e){}})}}}])}(angular);